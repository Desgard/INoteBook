{"version":3,"sources":["../src/marker.js"],"names":[],"mappings":";;;;;QA0BgB,S,GAAA,S;QAaA,S,GAAA,S;QAeA,e,GAAA,e;QA4BA,U,GAAA,U;QAQA,a,GAAA,a;;;;;;;;;;;;;;;AA5EhB,IAAM,cAAc,oBAApB;AACA,IAAM,eAAe,UAArB;AACA,IAAM,UAAU,SAAhB,C;AACA,IAAM,SAAS,QAAf,C;AACA,IAAM,YAAY,MAAlB,C;AACA,IAAM,mBAAmB,yBAAzB,C;;;;;;;AAOO,SAAS,SAAT,CAAmB,YAAnB,EAAiC;AACpC,WAAO,aAAa,MAApB;AACH;;;;;;;;;;AAWM,SAAS,SAAT,CAAmB,YAAnB,EAAiC;AACpC,QAAM,SAAS,UAAU,YAAV,CAAf;AACA,WAAQ,WAAW,SAAnB;AACH;;;;;;;;;;;;AAYM,SAAS,eAAT,CAAyB,IAAzB,EAA+B,UAA/B,EAA2C;AAC9C,QAAI,eAAe,SAAnB,EAA8B;AAC1B,eAAO,IAAP;AACH;;AAED,QAAM,SAAS,QAAQ,UAAR,GAAqB,KAApC;AACA,QAAM,UAAU,QAAQ,SAAR,GAAoB,WAApB,GAAkC,OAAlC,GAA4C,MAA5C,GAAqD,MAArD,GACV,MADU,GACD,YADC,GACc,MAD9B;;AAGA,QAAM,SAAS,UAAU,iBAAV,GAA8B,OAA7C;AACA,QAAM,MAAM,IAAI,MAAJ,CAAW,MAAX,CAAZ;AACA,QAAM,MAAM,KAAK,KAAL,CAAW,GAAX,CAAZ;;AAEA,QAAI,GAAJ,EAAS;AACL,eAAO,IAAI,CAAJ,CAAP,C;AACH,KAFD,MAEO;AACH,oBAAQ,IAAR,CAAa,iCAAiC,UAAjC,GAA8C,aAA3D;AACA,mBAAO,oBAAoB,UAApB,GAAiC,aAAxC;AACH;AACJ;;;;;;;;AASM,SAAS,UAAT,CAAoB,GAApB,EAAyB,GAAzB,EAA8B,GAA9B,EAAmC;AACtC,WAAO,IAAI,OAAJ,CAAY,IAAI,MAAJ,CAAW,GAAX,EAAgB,GAAhB,CAAZ,EAAkC,GAAlC,CAAP;AACH;;;;;;AAMM,SAAS,aAAT,CAAuB,IAAvB,EAA6B;;AAEhC,QAAM,SAAS,QAAQ,gBAAR,GAA2B,KAA1C;AACA,QAAM,UAAU,YAAY,WAAZ,GAA0B,OAA1B,GAAoC,MAApC,GAA6C,MAA7C,GACV,MADU,GACD,YADC,GACc,MAD9B;;AAGA,WAAO,WAAW,IAAX,EAAiB,OAAjB,EAA0B,EAA1B,CAAP;AACH","file":"marker.js","sourcesContent":["// LICENSE : MIT\n/*\n * Feature: doxygen like snippet code.\n * For code source documenting, see\n * https://www.stack.nl/~dimitri/doxygen/manual/commands.html#cmdsnippet\n *\n * Gibook usage:\n *\n *      [import:<markername>](path/to/file)\n *\n * NB: markername must begin with a letter to avoid conflict with slice\n *     line range.\n */\n\nconst commentOpen = \"(\\/+\\/+|#|%|\\/\\\\*)\";\nconst commentClose = \"(\\\\*\\/)?\";\nconst doxChar = \"[\\*!\\/]\"; // doxygen documentation character\nconst spaces = \"[ \\t]*\"; // h spaces\nconst spacesAny = \"\\\\s*\"; // h+v spaces\nconst markerNameFormat = \"(\\\\s*[a-zA-Z][\\\\w\\\\s]*)\"; // Must contain a char.\n\n/*\n * format: [import:<markername>](path/to/file)\n * @param {Object} keyValObject\n * @return {string}\n */\nexport function getMarker(keyValObject) {\n    return keyValObject.marker;\n}\n\n\n/**\n * format: [import:<markername>](path/to/file)\n * check if the import filled has a markername.\n * @example:\n *      hasMarker(label)\n * @param {Object} keyValObject\n * @returns {boolean}\n */\nexport function hasMarker(keyValObject) {\n    const marker = getMarker(keyValObject);\n    return (marker !== undefined);\n}\n\n/* Parse the code from given markers\n *\n * see test/marker-test.js\n */\n/**\n * get sliced code by {@link markername}\n * @param {string} code\n * @param {string} markername\n * @returns {string}\n */\nexport function markerSliceCode(code, markername) {\n    if (markername === undefined) {\n        return code;\n    }\n    // regex\n    const balise = \"\\\\[\" + markername + \"\\\\]\";\n    const pattern = \"\\\\n\" + spacesAny + commentOpen + doxChar + spaces + balise\n        + spaces + commentClose + spaces;\n\n    const regstr = pattern + \"\\\\n*([\\\\s\\\\S]*)\" + pattern;\n    const reg = new RegExp(regstr);\n    const res = code.match(reg);\n\n    if (res) {\n        return res[3]; // count parenthesis in pattern.\n    } else {\n        console.warn('markersSliceCode(): marker `' + markername + '` not found');\n        return 'Error: marker `' + markername + '` not found'\n    }\n}\n\n\n/** Replace all regex occurence by sub in the string str,\n * @param {string} str\n * @param {string} reg\n * @param {string} sub\n * @return {string}\n */\nexport function replaceAll(str, reg, sub) {\n    return str.replace(new RegExp(reg, 'g'), sub);\n}\n\n/** Function that remove all markers in the given code\n * @param {string} code\n * @return {string}\n */\nexport function removeMarkers(code) {\n    // various language comment\n    const balise = \"\\\\[\" + markerNameFormat + \"\\\\]\";\n    const pattern = spacesAny + commentOpen + doxChar + spaces + balise\n        + spaces + commentClose + spaces;\n\n    return replaceAll(code, pattern, '')\n}\n"]}